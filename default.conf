# <VirtualHost *:80>
#     ServerName localhost
#     # Set the document root
#     DocumentRoot "/var/www/html"
    
#   <Directory "/var/www/html">
#     # Allow overriding the default configuration via `.htaccess`
#     AllowOverride All
#   </Directory>
# </VirtualHost>

# Listen on port 80 and redirect all traffic to HTTPS
<VirtualHost *:80>
    ServerName ${index-journal.org}
    Redirect / ${https://index-journal.org/}
</VirtualHost>

# Listen on port 443 and serve HTTPS traffic
<VirtualHost *:443>
    ServerName ${index-journal.org}
    DocumentRoot /var/www/html

    # SSL configuration
    SSLEngine on
    SSLCertificateFile /path/to/cert.pem
    SSLCertificateKeyFile /path/to/privkey.pem
    SSLCertificateChainFile /path/to/chain.pem

    # Security headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Xss-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-src 'self';"

    # Logging
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    # Enable compression
    <IfModule mod_deflate.c>
        SetOutputFilter DEFLATE
        SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary
        SetEnvIfNoCase Request_URI \.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary
        SetEnvIfNoCase Request_URI \.pdf$ no-gzip dont-vary
    </IfModule>
</VirtualHost>
